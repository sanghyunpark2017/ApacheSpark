
 싱글마스터
 http://www.bench87.com/content/44
 
 마스터노드만기동되고슬레이브는기동되지않음
 
 
 
 
PART1. 싱글마스터


서버구성

10.10.64.73  t1vbigdata07 #master
10.10.64.74  t1vbigdata08 #node
10.10.64.75  t1vbigdata09 #node
10.10.64.76  t1vbigdata10 #node


#############################
## 프로토콜버퍼설치
#############################

su - 

systemctl stop firewalld


yum install -y protobuf-devel

protoc --version

#############################
## SSH설정
#############################


#모든서버에 하둡계정 생성


useradd hadoop
passwd hadoop


#모든서버 하둡계정으로 스위치하고 java home 설정(중요!! 이 프로파일을 사용함)
su - hadoop

cat << EOF >>  ~/.bashrc
export JAVA_HOME=/opt/jdk1.8.0_131
export JRE_HOME=/opt/jdk1.8.0_131/jre
EOF
 
source ~/.bashrc



#모든서버에 SSH 생성
ssh-keygen -t rsa



#마스터서버에서 SSH 복사

ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@t1vbigdata07.homeplusnet.co.kr
ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@t1vbigdata08.homeplusnet.co.kr
ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@t1vbigdata09.homeplusnet.co.kr
ssh-copy-id -i /home/hadoop/.ssh/id_rsa.pub hadoop@t1vbigdata10.homeplusnet.co.kr


#각 노드로 SSH 접속테스트 (hadoop -> hadoop@remote)

ssh hadoop@t1vbigdata07.homeplusnet.co.kr
ssh hadoop@t1vbigdata08.homeplusnet.co.kr
ssh hadoop@t1vbigdata09.homeplusnet.co.kr
ssh hadoop@t1vbigdata10.homeplusnet.co.kr




#############################
## 하둡다운로드(모든서버)
#############################

su - hadoop
wget http://apache.mirror.cdnetworks.com/hadoop/common/hadoop-2.7.4/hadoop-2.7.4.tar.gz
tar xzvf hadoop-2.7.4.tar.gz


중요!!! vi 편집기 사용

vi /home/hadoop/.bashrc
----------------------------------------------------
export HADOOP_HOME=/home/hadoop/hadoop-2.7.4
export HADOOP_CONF_DIR=$HADOOP_HOME/etc/hadoop
export PATH=$PATH:$HADOOP_HOME/bin
----------------------------------------------------

source /home/hadoop/.bashrc

echo $HADOOP_HOME
echo $HADOOP_CONF_DIR


#모든 노드에 마스터파일 **생성**


cat << EOF > $HADOOP_CONF_DIR/masters
t1vbigdata07.homeplusnet.co.kr
EOF

cat $HADOOP_CONF_DIR/masters

#마스터서버를 제외한 모든 슬레이브 노드에 슬레이브 파일 수정

cat << EOF > $HADOOP_CONF_DIR/slave
t1vbigdata08.homeplusnet.co.kr
t1vbigdata09.homeplusnet.co.kr
t1vbigdata10.homeplusnet.co.kr
EOF

cat $HADOOP_CONF_DIR/slave


#모든 노드에 core-site.xml 파일을 아래와 같이 수정 해준다.
vi $HADOOP_CONF_DIR/core-site.xml
------------------------------------------------
<configuration>
    <property>
        <name>fs.default.name</name>
        <value>hdfs://t1vbigdata07.homeplusnet.co.kr:9000</value>
    </property>
</configuration>
------------------------------------------------

#마스터 노드에만 hdfs-site.xml파일을 아래와 같이 수정 하자.


vi $HADOOP_CONF_DIR/hdfs-site.xml
------------------------------------------------
<configuration>
    <property>
        <name>dfs.replication</name>
        <value>2</value>
    </property>
    <property>
        <name>dfs.permissions</name>
        <value>false</value>
    </property>
    <property>
        <name>dfs.namenode.name.dir</name>
        <value>/home/hadoop/hadoop-2.7.4/namenode</value>
    </property>
    <property>
        <name>dfs.datanode.data.dir</name>
        <value>/home/hadoopjkk/hadoop-2.7.4/datanode</value>
    </property>
    <property>
        <name>dfs.namenode.datanode.registration.ip-hostname-check</name>
        <value>false</value>
    </property>
</configuration>
------------------------------------------------

#슬레이브 노드에만 hdfs-site.xml파일을 아래와 같이 수정 하자.


vi $HADOOP_CONF_DIR/hdfs-site.xml
------------------------------------------------
<configuration>
    <property>
        <name>dfs.replication</name>
        <value>2</value>
    </property>
    <property>
        <name>dfs.permissions</name>
        <value>false</value>
    </property>
    <property>
        <name>dfs.datanode.data.dir</name>
        <value>/home/hadoop/hadoop-2.7.4/datanode</value>
    </property>
</configuration>
------------------------------------------------


#모든 노드에 mapred-site.xml을 아래와 같이 수정한다.

cp $HADOOP_CONF_DIR/mapred-site.xml.template $HADOOP_CONF_DIR/mapred-site.xml
vi $HADOOP_CONF_DIR/mapred-site.xml
------------------------------------------------
<configuration>
    <property>
        <name>mapreduce.framework.name</name>
        <value>yarn</value>
    </property>
</configuration>
------------------------------------------------

#마스터 노드만 아래 명령어를 실행 해준다.

cd $HADOOP_HOME

hadoop namenode -format

./sbin/start-all.sh

./sbin/stop-all.sh


#마스터 노드는 웹사이트를 하나 호스트 하게 된다 아래 주소로 들어가서 정상적으로 실행되었는지 확인 해보자.

systemctl stop firewalld

http://t1vbigdata07.homeplusnet.co.kr:50070/dfshealth.html




 



PART2. 멀티마스터






































