


#csv
df = spark.read.load("examples/src/main/resources/people.csv",
                     format="csv", sep=":", inferSchema="true", header="true")

#####################################
mariadb jdbc download
#####################################

https://downloads.mariadb.org/connector-java/

ex) 
wget https://downloads.mariadb.com/Connectors/java/connector-java-2.2.3/mariadb-java-client-2.2.3.jar

/home/user

#
./pyspark  --driver-class-path /home/user/mariadb-java-client-2.2.3.jar --jars /home/user/mariadb-java-client-2.2.3.jar



from pyspark.sql import SparkSession

spark = SparkSession.builder.appName("sparkanalysis").config("spark.driver.extraClassPath","/home/user/mariadb-java-client-2.2.3.jar").getOrCreate()

//for localhost database//

pgDF = spark.read \
.format("jdbc") \
.option("url", "jdbc:postgresql:postgres") \
.option("dbtable", "public.user_emp_tab") \
.option("user", "root") \
.option("password", "P@ssw0rd") \
.load()


print(pgDF)

pgDF.filter(pgDF["user_id"]>5).show()



